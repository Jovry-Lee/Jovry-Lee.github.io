---
title: 操作系统-线程
date: 2021-03-20 00:33:50
tags: ["操作系统","线程", "现代操作系统"]
categories: ["操作系统","线程", "Note"]
---

1 简介

既然已经有了进程，为什么还要引入线程呢？或者说使用线程有何优点？

- 线程拥有共享一个地址空间和所有可用数据的能力；
- 线程比进程更轻量级，所以它们比进程更容易、更快创建及撤销；
- 线程对于存在着大量的计算和大量的I/O处理的活动，能重叠执行，加快应用程序执行速度，提升性能。（注：`多线程对于CPU密集型活动，并不能获得性能上的提升`）

<!--more-->

进程拥有一个执行的线程，线程拥有：

- 程序计数器：用于记录接着要执行的指令；
- 寄存器：用于保存线程当前的工作变量（局部变量以及过程调用之后使用的返回地址）；
- 堆栈：用于记录执行历史，其中每一帧保存了一个一调用，但还未从中返回的过程；
- 状态：与进程一直，有运行、阻塞、就绪、终止状态。状态间的转换和进程一致。



注：`进程用于把资源集中到一起，而线程则是在CPU上被调度执行的实体。`



2 多线程

在多线程的情况下，进程通常会从当前的单个线程开始。常见的线程调用如下：

- 创建：这个线程有能力通过调用一个系统函数创建新线程（如：thread_create）。创建线程通常都会返回一个线程标识符，该标识符就是线程的名称。注：`线程间通常是平等的，不存在父子关系（特殊情况除外）。`
- 退出：当一个线程执行完成后，可以通过调用一个库函数（如：thread_exit）退出。退出的线程不再被调度。
- 等待其他线程：有时会需要等待其他线程退出，此时可通过调用一个库函数（如：thread_join）等待。此时当前线程将被阻塞，直到另一个线程退出。
- 让出CPU：线程无法像进程一样通过时钟中断方式强制让出CPU，而某些场景下一个线程需要等待另外一个线程执行完成后，再进程操作。所以系统提供一个库函数（如：thread_yield）。



